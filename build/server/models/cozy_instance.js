<<<<<<< HEAD
// Generated by CoffeeScript 1.7.1
var CozyInstance, americano, log, path;
=======
// Generated by CoffeeScript 1.9.0
var CozyInstance, americano;
>>>>>>> 95d0785fad0c21a4f96bf50b6af6e224172f5c42

americano = require('americano-cozy-pouchdb');

path = require('path');

log = require('printit')({
  prefix: 'Calendar'
});

module.exports = CozyInstance = americano.getModel('CozyInstance', {
  id: {
    type: String
  },
  domain: {
    type: String
  },
  locale: {
    type: String
  }
});

CozyInstance.first = function(callback) {
  var configPath, instance;
  configPath = path.join(process.cwd(), 'config');
  try {
    instance = require(configPath);
  } catch (_error) {
    console.log(err);
    log.error('No config file found at ' + configPath);
    instance = {};
  }
  if (instance.domain == null) {
    instance.domain = 'default.domain.com';
  }
  if (instance.locale == null) {
    instance.locale = 'en';
  }
  return callback(null, instance);
};

CozyInstance.getURL = function(callback) {
  return CozyInstance.first(function(err, instance) {
    return callback(null, instance.domain);
  });
};

CozyInstance.getLocale = function(callback) {
  return CozyInstance.first(function(err, instance) {
    return callback(null, instance.locale);
  });
};
