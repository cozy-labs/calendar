// Generated by CoffeeScript 1.7.1
var User, americano, log, path;

americano = require('americano-cozy-pouchdb');

path = require('path');

log = require('printit')({
  prefix: 'Calendar'
});

module.exports = User = americano.getModel('User', {
  email: {
    type: String
  },
  timezone: {
    type: String,
    "default": "Europe/Paris"
  }
});

User.all = function(callback) {
  return User.request("all", callback);
};

User.destroyAll = function(callback) {
  return User.requestDestroy("all", callback);
};

User.getTimezone = function(callback) {
  var configPath, err, user;
  configPath = path.join(process.cwd(), 'config');
  try {
    user = require(configPath);
  } catch (_error) {
    err = _error;
    console.log(err);
    log.error('No config file found at ' + configPath);
    user = {};
  }
  if (user.timezone == null) {
    user.timezone = "Europe/Paris";
  }
  return callback(null, user.timezone);
};

User.updateTimezone = function(callback) {
  return User.getTimezone(function(err, timezone) {
    User.timezone = timezone;
    return typeof callback === "function" ? callback() : void 0;
  });
};
